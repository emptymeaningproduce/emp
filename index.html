<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>emp</title>
  <style>
    :root{
      --pad: 24px;
      --max: 900px;
      --linkSize: 14px;
      --headingSize: 14px;
    }

    html, body{
      height: 100%;
      margin: 0;
      background: #fff;
      color: #000;
      font-family: Arial, Helvetica, sans-serif;
    }

    #loop{
      height: 100vh;
      overflow-y: auto;
      overscroll-behavior: none;
      -webkit-overflow-scrolling: touch;
    }

    .wrap{
      max-width: var(--max);
      margin: 0 auto;
      padding: 40px var(--pad);
    }

    .logo{
      width: 640px;
      max-width: 92vw;
      height: auto;
      display: block;
      margin: 20px auto 28px;
    }

    .links{
      text-align: left;
    }

    h3{
      font-size: var(--headingSize);
      font-weight: 700;
      margin: 22px 0 8px;
    }

    a{
      display: block;
      font-size: var(--linkSize);
      margin: 6px 0;
      color: #00f;
      text-decoration: underline;
    }

    .spacer{ height: 10px; }

    a:focus{
      outline: 2px dotted #000;
      outline-offset: 2px;
    }

    /* Image BGM button */
    .music{
      position: fixed;
      right: 14px;
      bottom: 14px;
      z-index: 9999;
      user-select: none;
    }

    .musicBtn{
      border: 0;
      padding: 0;
      background: transparent;
      cursor: pointer;
      display: inline-block;
      line-height: 0;
    }

    .musicBtn img{
      width: 72px;
      height: auto;
      display: block;
    }

    .musicBtn.is-off{
      opacity: 0.45;
    }

    .musicBtn.is-on{
      opacity: 1;
    }

    .musicBtn:focus{
      outline: 2px dotted #000;
      outline-offset: 4px;
    }
  </style>
</head>
<body>
  <audio id="bgm" src="emp_sound.mp3" loop preload="auto"></audio>

  <div class="music">
    <button id="musicBtn" class="musicBtn is-off" type="button" aria-label="Toggle background music">
      <img src="logo_button.JPG" alt="Toggle music" />
    </button>
  </div>

  <div id="loop">
    <div id="stage"></div>

    <template id="tpl">
      <div class="wrap">
        <img class="logo" src="logo.png" alt="Logo" />

        <div class="links">
          <h3>MERCH</h3>
          <a href="https://example.com">MERCH</a>

          <div class="spacer"></div>

          <h3>NEW</h3>
          <a href="https://example.com">Track 1</a>
          <a href="https://example.com">Track 2</a>

          <h3>OTHER PLATFORMS</h3>
          <a href="https://youtube.com">YouTube</a>
          <a href="https://instagram.com/mokyofuckyo">Instagram</a>
          <a href="https://soundcloud.com">SoundCloud</a>

          <h3>CONTACT</h3>
          <a href="mailto:emptymeaningproduce@gmail.com">emptymeaningproduce@gmail.com</a>
        </div>
      </div>
    </template>
  </div>

  <script>
    (function(){
      // ===== Infinite scroll (up/down) =====
      const loop = document.getElementById("loop");
      const stage = document.getElementById("stage");
      const tpl = document.getElementById("tpl");

      const copies = [];
      for(let i=0;i<3;i++){
        const node = tpl.content.cloneNode(true);
        const wrapper = document.createElement("div");
        wrapper.className = "copy";
        wrapper.appendChild(node);
        stage.appendChild(wrapper);
        copies.push(wrapper);
      }

      function getCopyHeight(){
        return copies[0].getBoundingClientRect().height;
      }

      function centerScroll(){
        const h = getCopyHeight();
        loop.scrollTop = h;
      }

      function onScroll(){
        const h = getCopyHeight();
        const y = loop.scrollTop;
        const threshold = 200;

        if(y < threshold){
          loop.scrollTop = y + h;
          return;
        }

        const maxY = loop.scrollHeight - loop.clientHeight;
        if(maxY - y < threshold){
          loop.scrollTop = y - h;
          return;
        }
      }

      window.addEventListener("load", () => {
        centerScroll();
        loop.addEventListener("scroll", onScroll, { passive: true });
      });

      window.addEventListener("resize", () => {
        centerScroll();
      });

      // ===== Background music (image button toggle) =====
      const audio = document.getElementById("bgm");
      const btn = document.getElementById("musicBtn");

      function setButtonState(isOn){
        btn.classList.toggle("is-on", isOn);
        btn.classList.toggle("is-off", !isOn);
      }

      async function toggleMusic(){
        try{
          if(audio.paused){
            audio.muted = false;
            await audio.play();
            setButtonState(true);
          }else{
            audio.pause();
            setButtonState(false);
          }
        }catch(e){
          setButtonState(false);
        }
      }

      btn.addEventListener("click", toggleMusic);

      // Optional: try muted autoplay silently
      window.addEventListener("load", async () => {
        try{
          audio.muted = true;
          await audio.play();
          setButtonState(false);
        }catch(e){
          setButtonState(false);
        }
      });
    })();
  </script>
</body>
</html>
